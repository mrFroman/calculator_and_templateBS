(function(){"use strict";var e={8219:function(e,t,n){var o=n(9242),s=n(3396),a=n.p+"img/header.96c617ce.jpg",r=n.p+"img/footer.4d00a921.jpg";const i={class:"main"},l={class:"main__panel"},p={class:"email"},d={class:"email__template"},c=(0,s._)("div",{class:"header"},[(0,s._)("img",{src:a,alt:""})],-1),u=(0,s._)("div",{class:"footer"},[(0,s._)("img",{src:r,alt:""})],-1);function v(e,t,n,o,a,r){const v=(0,s.up)("events-upload"),m=(0,s.up)("choose-template"),h=(0,s.up)("violett-button"),_=(0,s.up)("events-list"),f=(0,s.up)("email-template");return(0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",l,[(0,s.Wm)(v,{onLoadEvents:r.getEvents,ref:"replaceEvent"},null,8,["onLoadEvents"]),(0,s.Wm)(m,{onChoose:r.choose},null,8,["onChoose"]),(0,s.Wm)(h,{style:{margin:"0"},onClick:r.getDemoEvents},{default:(0,s.w5)((()=>[(0,s.Uk)(" Получить демоданные из базы данных ")])),_:1},8,["onClick"])]),(0,s.Wm)(_,{events:a.events,onRemove:r.removeEvent,onReplace:r.replaceEvent},null,8,["events","onRemove","onReplace"]),(0,s._)("div",p,[(0,s._)("div",d,[c,(0,s.Wm)(f,{template:a.template},null,8,["template"]),u])])])}n(7658);const m=e=>((0,s.dD)("data-v-2148cd46"),e=e(),(0,s.Cn)(),e),h={class:"events"},_=m((()=>(0,s._)("h4",{class:"events__title"},"Список мероприятий",-1))),f={class:"events__list"},g={class:"events"},w=m((()=>(0,s._)("h4",null,"Список мероприятий пуст",-1))),k=[w];function b(e,t,n,a,r,i){const l=(0,s.up)("events-item");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.wy)((0,s._)("div",h,[_,(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.events,(n=>((0,s.wg)(),(0,s.j4)(l,{event:n,key:n.id,onRemove:t=>e.$emit("remove",n),onReplace:t[0]||(t[0]=t=>e.$emit("replace"))},null,8,["event","onRemove"])))),128))])],512),[[o.F8,n.events.length>0]]),(0,s.wy)((0,s._)("div",g,k,512),[[o.F8,0===n.events.length]])],64)}var y=n(7139);const D=e=>((0,s.dD)("data-v-51ad1118"),e=e(),(0,s.Cn)(),e),P={class:"card__body"},T=D((()=>(0,s._)("strong",null,"Дата: ",-1))),C=D((()=>(0,s._)("strong",null,"Цена: ",-1))),x=D((()=>(0,s._)("strong",null,"Ценз: ",-1))),E={class:"card__buttons"};function O(e,t,n,o,a,r){const i=(0,s.up)("pink-button");return(0,s.wg)(),(0,s.iD)("div",{class:"events__card",draggable:"true",onDragstart:t[2]||(t[2]=e=>r.dragStart(e,n.event))},[(0,s._)("h4",null,(0,y.zw)(n.event.title),1),(0,s._)("div",P,[(0,s._)("div",null,[T,(0,s.Uk)((0,y.zw)(n.event.date),1)]),(0,s._)("div",null,[C,(0,s.Uk)((0,y.zw)(n.event.price),1)]),(0,s._)("div",null,[x,(0,s._)("span",null,(0,y.zw)(n.event.rate),1)]),(0,s._)("div",E,[(0,s.Wm)(i,{onClick:t[0]||(t[0]=t=>e.$emit("replace"))},{default:(0,s.w5)((()=>[(0,s.Uk)(" Заменить ")])),_:1}),(0,s.Wm)(i,{onClick:t[1]||(t[1]=t=>e.$emit("remove",n.event))},{default:(0,s.w5)((()=>[(0,s.Uk)(" Удалить ")])),_:1})])])],32)}function j(e,t,n,o,a,r){return(0,s.wg)(),(0,s.iD)("button",null,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])}var z={name:"PinkButton"},M=n(89);const $=(0,M.Z)(z,[["render",j],["__scopeId","data-v-7c52115e"]]);var I=$,W={components:{PinkButton:I},props:{event:{type:Object,required:!0}},methods:{dragStart(e,t){e.dataTransfer.dropEffect="copy",e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("event",JSON.stringify(t))}}};const U=(0,M.Z)(W,[["render",O],["__scopeId","data-v-51ad1118"]]);var Z=U,q={components:{EventsItem:Z},emits:["remove","replace"],props:{events:{type:Array,required:!0}}};const V=(0,M.Z)(q,[["render",b],["__scopeId","data-v-2148cd46"]]);var L=V;const R=e=>((0,s.dD)("data-v-c902ac2e"),e=e(),(0,s.Cn)(),e),S={class:"form"},N=R((()=>(0,s._)("h4",null,"Вставьте ссылки на мероприятия, через запятую",-1))),B={key:0};function H(e,t,n,a,r,i){const l=(0,s.up)("my-textarea"),p=(0,s.up)("violett-button"),d=(0,s.up)("my-modal");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(d,{show:r.isVisible,"onUpdate:show":t[2]||(t[2]=e=>r.isVisible=e)},{default:(0,s.w5)((()=>[(0,s._)("form",S,[N,(0,s.Wm)(l,{value:r.eventsLinks,"onUpdate:value":t[0]||(t[0]=e=>r.eventsLinks=e),placeholder:r.placeholder,onFocus:t[1]||(t[1]=e=>r.error="")},null,8,["value","placeholder"]),r.error?((0,s.wg)(),(0,s.iD)("p",B,(0,y.zw)(r.error),1)):(0,s.kq)("",!0),(0,s.Wm)(p,{onClick:(0,o.iM)(i.loadEvents,["prevent"])},{default:(0,s.w5)((()=>[(0,s.Uk)(" Добавить мероприятия ")])),_:1},8,["onClick"])])])),_:1},8,["show"]),(0,s.Wm)(p,{style:{"margin-top":"0"},onClick:i.modalOpen},{default:(0,s.w5)((()=>[(0,s.Uk)(" Добавить мероприятия ")])),_:1},8,["onClick"])])}const Y=["value"];function F(e,t,n,o,a,r){return(0,s.wg)(),(0,s.iD)("textarea",{value:n.value,onInput:t[0]||(t[0]=(...e)=>r.updateTextarea&&r.updateTextarea(...e)),class:"textarea"},null,40,Y)}var K={name:"MyTextarea",props:{value:[String,Number]},methods:{updateTextarea(e){this.$emit("update:value",e.target.value)}}};const A=(0,M.Z)(K,[["render",F],["__scopeId","data-v-5db06220"]]);var J=A,G={emits:["loadEvents"],components:{MyTextarea:J},data(){return{eventsLinks:"",isVisible:!1,placeholder:"Например \nhttps://ekb.kassy.ru/events/teatr/2-54300/\nhttps://ekb.kassy.ru/events/koncerty-i-shou/3-13203509/\nhttps://ekb.kassy.ru/events/koncerty-i-shou/2-53902/",error:""}},methods:{modalOpen(){this.isVisible=!0},loadEvents(){!this.eventsLinks&&(this.error="Добавьте минимум 1 ссылку на мероприятие");const e=/^((http[s]:\/\/))?((\w*)|(\w*-\w*)).?(kassy).(ru)\/(events)\/((\w*-\w*-\w*)|(\w*)|(\w*-\w*))\/(\d*.\d*)/,t=this.eventsLinks.replace(/\s/g,"").replace(",","").replace(new RegExp("https:","g"),"*https:").split("*").filter((e=>""!==e)).map((t=>e.test(t)?t:this.error+=`Не корректная ссылка ${t}`));this.error||(this.$emit("loadEvents",t),this.eventsLinks="",this.isVisible=!1)}}};const Q=(0,M.Z)(G,[["render",H],["__scopeId","data-v-c902ac2e"]]);var X=Q;const ee=e=>((0,s.dD)("data-v-d0859550"),e=e(),(0,s.Cn)(),e),te={class:"choose"},ne=ee((()=>(0,s._)("h4",null,"Выберите формат рассылки: ",-1))),oe=ee((()=>(0,s._)("h4",null,"Формат рассылки:",-1)));function se(e,t,n,o,a,r){const i=(0,s.up)("choose-template-buttons"),l=(0,s.up)("my-modal"),p=(0,s.up)("violett-button");return(0,s.wg)(),(0,s.iD)("div",te,[(0,s.Wm)(l,{show:a.isVisible,"onUpdate:show":t[0]||(t[0]=e=>a.isVisible=e)},{default:(0,s.w5)((()=>[ne,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.buttons,(e=>((0,s.wg)(),(0,s.j4)(i,{button:e,key:e.data,onTemplate:t=>r.chooseTemplate(e)},null,8,["button","onTemplate"])))),128))])),_:1},8,["show"]),oe,(0,s.Wm)(p,{style:{"margin-top":"0"},onClick:r.modalOpen},{default:(0,s.w5)((()=>[(0,s.Uk)((0,y.zw)(a.template),1)])),_:1},8,["onClick"])])}function ae(e,t,n,o,a,r){const i=(0,s.up)("violett-button");return(0,s.wg)(),(0,s.j4)(i,{onClick:t[0]||(t[0]=t=>e.$emit("template",this.button))},{default:(0,s.w5)((()=>[(0,s.Uk)((0,y.zw)(n.button.name),1)])),_:1})}var re={emits:["template"],props:{button:{type:Object}}};const ie=(0,M.Z)(re,[["render",ae]]);var le=ie,pe={emits:["choose"],components:{ChooseTemplateButtons:le},data(){return{isVisible:!1,buttons:[{name:"1 топ",data:{tops:1,headPoster:0,footerPoster:0}},{name:"2 топа",data:{tops:2,headPoster:0,footerPoster:0}},{name:"3 топа",data:{tops:3,headPoster:0,footerPoster:0}},{name:"1 топ 3 афиши",data:{tops:1,headPoster:3,footerPoster:0}},{name:"1 топ 6 афиш",data:{tops:1,headPoster:6,footerPoster:0}},{name:"2 топа 3 афиши",data:{tops:2,headPoster:3,footerPoster:0}},{name:"2 топа 6 афиш",data:{tops:2,headPoster:6,footerPoster:0}},{name:"2 топа 9 афиш",data:{tops:2,headPoster:6,footerPoster:3}},{name:"2 топа 12 афиш",data:{tops:2,headPoster:6,footerPoster:6}},{name:"3 топа 9 афиш",data:{tops:3,headPoster:6,footerPoster:3}},{name:"3 топа 12 афиш",data:{tops:3,headPoster:6,footerPoster:6}},{name:"Техническая рассылка",data_type:"tech"}],template:"Выбрать формат"}},methods:{modalOpen(){this.isVisible=!0},chooseTemplate(e){this.$emit("choose",e),this.template=e.name,this.isVisible=!1}}};const de=(0,M.Z)(pe,[["render",se],["__scopeId","data-v-d0859550"]]);var ce=de;const ue={class:"root"},ve={key:0},me={class:"head__poster"},he={class:"footer__poster"};function _e(e,t,n,o,a,r){const i=(0,s.up)("top-template"),l=(0,s.up)("poster-template");return(0,s.wg)(),(0,s.iD)("div",ue,["Формат не выбран"===n.template?((0,s.wg)(),(0,s.iD)("div",ve," Формат не выбран ")):(0,s.kq)("",!0),n.template.tops>0?((0,s.wg)(),(0,s.j4)(i,{key:1,class:"top_1",template:n.template,"is-text":!0},null,8,["template"])):(0,s.kq)("",!0),(0,s._)("div",me,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.template.headPoster,(e=>((0,s.wg)(),(0,s.j4)(l,{poster:e},null,8,["poster"])))),256))]),n.template.tops>1?((0,s.wg)(),(0,s.j4)(i,{key:2,class:"top_2",template:n.template,"is-text":r.isText},null,8,["template","is-text"])):(0,s.kq)("",!0),(0,s._)("div",he,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.template.footerPoster,(e=>((0,s.wg)(),(0,s.j4)(l,{poster:e},null,8,["poster"])))),256))]),n.template.tops>2?((0,s.wg)(),(0,s.j4)(i,{key:3,class:"top_3",template:n.template,"is-text":r.isText},null,8,["template","is-text"])):(0,s.kq)("",!0)])}const fe=["src"],ge={key:0},we={contenteditable:"true"},ke={key:0,class:"pushkin"},be=["href"];function ye(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.wy)((0,s._)("div",{class:"modal",onClick:t[0]||(t[0]=(...e)=>i.closeModal&&i.closeModal(...e))},"123",512),[[o.F8,r.isModal]]),(0,s._)("div",{class:"top",onDragover:t[2]||(t[2]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=e=>i.dragDrop(e))},[(0,s._)("img",{src:r.event.image,alt:"",onClick:t[1]||(t[1]=(...e)=>i.modal&&i.modal(...e))},null,8,fe),n.isText?((0,s.wg)(),(0,s.iD)("div",ge,[(0,s._)("p",we,(0,y.zw)(r.event.description),1),r.event.is_pushkin_card?((0,s.wg)(),(0,s.iD)("p",ke," Действует Пушкинская карта ")):(0,s.kq)("",!0),(0,s._)("p",null,(0,y.zw)(r.event.date)+" "+(0,y.zw)(r.event.time)+" "+(0,y.zw)(r.event.venue),1),(0,s._)("a",{href:r.event.link,target:"_blank"},"Выбрать место",8,be)])):(0,s.kq)("",!0)],32)],64)}var De=n.p+"img/plug600.69f0e825.png",Pe=n(9093),Te={components:{Cropper:Pe.fl},props:{template:{type:Object},isText:{type:Boolean}},data(){return{event:{description:"Описание мероприятия",date:"Дата",time:"Время",venue:"Место",is_pushkin_card:!1,image:De},canvas:null,isModal:!1}},methods:{dragDrop(e){const t=JSON.parse(e.dataTransfer.getData("event"));this.event=Object.assign(this.event,t)},change({coordinates:e,canvas:t}){},defaultSize({imageSize:e,visibleArea:t}){return{width:(t||e).width,height:(t||e).height}},modal(){this.isModal=!0},closeModal(){this.isModal=!1}}};const Ce=(0,M.Z)(Te,[["render",ye],["__scopeId","data-v-3aed6c32"]]);var xe=Ce;const Ee=["src"],Oe={class:"poster__body"},je={class:"poster__category"},ze={class:"poster__title",contenteditable:"true"},Me={class:"poster__pushkin"},$e={key:0},Ie={style:{"font-size":"13px"}},We={class:"poster__date"},Ue={class:"poster__time"},Ze={class:"poster__rate"},qe={class:"poster__venue",contenteditable:"true"},Ve=["href"];function Le(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",{class:"poster",onDragover:t[0]||(t[0]=(0,o.iM)((()=>{}),["prevent"])),onDrop:t[1]||(t[1]=e=>i.dragDrop(e))},[(0,s._)("img",{src:r.event.image,alt:"image",draggable:!1},null,8,Ee),(0,s._)("div",Oe,[(0,s._)("p",je,(0,y.zw)(r.event.category),1),(0,s._)("p",ze,(0,y.zw)(r.event.title),1),(0,s._)("p",Me,[r.event.is_pushkin_card?((0,s.wg)(),(0,s.iD)("span",$e,"Пушкинская карта")):(0,s.kq)("",!0)]),(0,s._)("p",Ie,[(0,s._)("span",We,(0,y.zw)(r.event.date),1),(0,s.Uk)(),(0,s._)("span",Ue,(0,y.zw)(i.updateTime),1),(0,s.Uk)(),(0,s._)("span",Ze,(0,y.zw)(r.event.rate),1)]),(0,s._)("p",qe,(0,y.zw)(r.event.venue),1),(0,s._)("a",{class:"poster__price",href:r.event.link,target:"_blank"},(0,y.zw)(i.splitPrice),9,Ve)])],32)}var Re=n.p+"img/plug300.f710ae99.png",Se={data(){return{event:{category:"Категория",title:"Название",is_pushkin_card:!1,date:"Дата",time:"Время",rate:"0+",venue:"Место",price:"0",image:Re}}},methods:{dragDrop(e){const t=JSON.parse(e.dataTransfer.getData("event"));this.event=Object.assign(this.event,t)}},computed:{splitPrice:function(){return this.event.price.split("—").length>1?`от ${this.event.price.split("—")[0]} Р`:`${this.event.price.split("—")[0]} Р`},updateTime:function(){return`в ${this.event.time}`}}};const Ne=(0,M.Z)(Se,[["render",Le],["__scopeId","data-v-db0b4654"]]);var Be=Ne,He={components:{PosterTemplate:Be,TopTemplate:xe},props:{template:{tops:{type:Number},headPoster:{type:Number},footerPoster:{type:Number}}},computed:{isText(){return this.template.tops>1&&0===this.template.footerPoster&&0===this.template.headPoster}}};const Ye=(0,M.Z)(He,[["render",_e],["__scopeId","data-v-6a519b8e"]]);var Fe=Ye,Ke=n(4161);function Ae(e,t,n,o,a,r){return(0,s.wg)(),(0,s.iD)("button",null,[(0,s.WI)(e.$slots,"default",{},void 0,!0)])}var Je={name:"ViolettButton"};const Ge=(0,M.Z)(Je,[["render",Ae],["__scopeId","data-v-092d0a44"]]);var Qe=Ge,Xe={components:{EmailTemplate:Fe,EventsList:L,EventsUpload:X,ChooseTemplate:ce},data(){return{events:[],template:"Формат не выбран"}},methods:{removeEvent(e){this.events=this.events.filter((t=>t.id!==e.id))},choose(e){this.template=e.data},getEvents(e){Promise.all(e.map((e=>{Ke.Z.get(`https://9cdc-46-229-111-78.eu.ngrok.io/events?link=${e}`).then((e=>this.events.push(e.data)))})))},getDemoEvents(){Ke.Z.get("https://9cdc-46-229-111-78.eu.ngrok.io/events/demo").then((e=>this.events.push(...e.data)))},replaceEvent(){this.$refs.replaceEvent.modalOpen()}}};const et=(0,M.Z)(Xe,[["render",v]]);var tt=et;function nt(e,t,n,a,r,i){return n.show?((0,s.wg)(),(0,s.iD)("div",{key:0,class:"dialog",onClick:t[1]||(t[1]=e=>i.hideModal(e))},[(0,s._)("div",{class:"dialog__content",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},[(0,s.WI)(e.$slots,"default",{},void 0,!0)])])):(0,s.kq)("",!0)}var ot={name:"MyModal",props:{show:{type:Boolean,default:!1}},methods:{hideModal(){this.$emit("update:show",!1)}}};const st=(0,M.Z)(ot,[["render",nt],["__scopeId","data-v-cf904a76"]]);var at=st,rt=[I,Qe,J,at];const it=(0,o.ri)(tt);rt.forEach((e=>{it.component(e.name,e)})),it.mount("#app")}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,a){if(!o){var r=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],a=e[d][2];for(var i=!0,l=0;l<o.length;l++)(!1&a||r>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(i=!1,a<r&&(r=a));if(i){e.splice(d--,1);var p=s();void 0!==p&&(t=p)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,s,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,a,r=o[0],i=o[1],l=o[2],p=0;if(r.some((function(t){return 0!==e[t]}))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(l)var d=l(n)}for(t&&t(o);p<r.length;p++)a=r[p],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},o=self["webpackChunkbs_vue"]=self["webpackChunkbs_vue"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(8219)}));o=n.O(o)})();
//# sourceMappingURL=app.f90724df.js.map